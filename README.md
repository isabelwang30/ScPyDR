# scPyDR
### Single-Cell Python Dimensionality Reduction
`scPyDR` is a Python package containing tools for the dimensionality reduction and visualization of single-cell RNA sequencing data. The three tools are simpler versions of Scanpy's [`scanpy.pp.pca`](https://scanpy.readthedocs.io/en/stable/generated/scanpy.pp.pca.html), [`scanpy.tl.tsne`](https://scanpy.readthedocs.io/en/stable/generated/scanpy.tl.tsne.html), and [`scanpy.tl.umap`](https://scanpy.readthedocs.io/en/stable/generated/scanpy.tl.umap.html).

[Prerequisites](#Prerequisites) | [Installation](#Installation) | [Basic Usage](#Usage) | [scPyDR Options](#Options) | [File Formats](#Formats) | 
[Contributors](#Contributors)

## Prerequisites<a name="Prerequisites"></a>
`scPyDR` requires the following python libraries to be installed:
* numpy
* pandas
* matplotlib
* anndata
* scanpy
* umap

These can be installed with the following `pip` command:
```
pip install numpy pandas matplotlib anndata scanpy umap
```

*Note: if you do not have root access, the packages can be installed locally with the following command:*
```
pip install --user numpy pandas matplotlib anndata scanpy umap
```

## Installation<a name="Installation"></a>
Once the required libraries are installed, `scPyDR` can be installed with the following commands:
```
git clone https://github.com/isabelwang30/scPyDR.git
cd scPyDR
python setup.py install
```

*Note: if you do not have root access, `scPyDR` can be installed locally with the following commands:*
```
git clone https://github.com/isabelwang30/scPyDR.git
cd scPyDR
python setup.py install --user
```

If the install was successful, the command `scpydr --help` should show a useful help message.

*Note: if you get an error that says the `scpydr` command was not found, you may need to include the script installation path in your `$PATH` variable before calling `scpydr`. You can do this with the following command, replacing `<user>` with your own username:*
```
export PATH=$PATH:/home/<user>/.local/bin
```

## Basic Usage<a name="Usage"></a>
The basic usage of scPyDR is as follows:
```
scpydr [DATADIR] [other options]
```

To run `scPyDR` on a small test example (see `benchmark` in this repo):
```
scpydr benchmark
```

With the same test example, to run `scPyDR`'s PCA and UMAP functions and visualize the UMAP results:
```
scpydr benchmark -u -v
```

## scPyDR Options<a name="Options"></a>
scPyDR requires the following input file:
* `[DATADIR]`: Directory containing 10x Genomics scRNA-seq data files. See below for format specifications on the 10x Genomics data files.

Additional options include:
* `-o`, `--output` `[OUTDIR]`: Output directory to store results. Default: working directory.
* `-g`, `--min_genes` `[INT]`: Minimum number of genes expressed per cell. Default: 200.
* `-c`, `--min_cells` `[INT]`: Minimum number of cells expressing a gene. Default: 5.
* `-cr`, `--min_cell_reads` `[INT]`: Minimum number of reads per cell. Default: None.
* `-gc`, `--min_gene_counts` `[INT]`: Minimum number of counts per gene. Default: None.
* `-ntop`, `--n_top_genes` `[INT]`: Number of highly variable genes to keep. Default: 500.
* `-t`, `--target_sum` `[FLOAT]`: Number of reads per cell for normalization. Default: 1e4.
* `-n`, `--nComp` `[INT]`: Number of principal componenets. Default: for n data points and m features, there are min(n-1,m) PCs.
* `--version`: Print the version of scPyDR.
* `-u`, `--umap`: Run UMAP for dimensionality reduction and visualization.
* `-v`, `--visualize`: Visualize the results of scPyDR.

## File Formats<a name="Formats"></a>
The input file should be a count matrix from `10X cellranger`'s `cellranger count` analysis pipeline. A widely-used source to publish and find such count matrices from scRNA-seq data is [GEO](https://www.ncbi.nlm.nih.gov/geo/). The benchmarking data for this package was found on GEO. Read more on the count matrix file format [here](https://www.10xgenomics.com/support/software/cell-ranger-arc/latest/analysis/feature-barcode-matrices). 

*NOTE:* To run scPyDR, the barcodes and features matrices should be loaded as gzip files and placed into a single directory. Use the name of this directory (as a `str`) as the input to scPyDR.

## Contributors<a name="Contributors"></a>
This repository was generated by Anushka Sheoran, Isabel Wang, and Monica Park with inspiration from the [mypileup](https://github.com/gymreklab/cse185-demo-project#readme) project demo and the projects of peers. If any issues should arise, please submit a pull request with any corrections or suggestions. Thank you!